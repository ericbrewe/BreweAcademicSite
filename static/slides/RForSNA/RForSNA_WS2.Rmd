---
title: "R For SNA"
subtitle: Workshop 2
author: 'Eric Brewe <br> Associate Professor of Physics at Drexel University <br>'
date: "11 August 2020, last update: `r Sys.Date()`"
output: 
  xaringan::moon_reader:
    css: [default, metropolis, "BreweSlides.css"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse) # load tidyverse package
library(emo) # load emoji package
library(igraph)
library(tidygraph)
library(ggraph)
library(here)

```


# Welcome Back!

### Workshop #1 was a sprint!
This should be a bit more reasonably paced. 

First of all, we will not need to build the network all over again. 

But we should start with some [project-oriented workflow.](<https://www.tidyverse.org/blog/2017/12/workflow-vs-script/>)

The blog post by Jenny Bryan linked above describes the basic logic for a project orinted workflow. 

Each project gets:
- It's own folder
- A project file (which you never open)
- As many Rmarkdown or R script files as needed
- Subfolders for:
    - data
    - plots
    - reports/papers etc.

---
# Let's build on our project oriented workflow

### Our project is about building and analyzing the Workshop network

So we will **not** need a new project folder, we will continue to use RForSNA, which you should have set up in WS1. 

This time we will add a new .Rmd file, give it a title like "node_properties.Rmd"

So navigate to your RForSNA file and create a new .Rmd file. 

Then, add a code chunk to load the libraries necessary and run this chunk.

```{r LoadPackages, eval=FALSE}
library(tidyverse) #tools for cleaning data 
library(igraph)  #package for doing network analysis
library(tidygraph) #tools for doing tidy networks
library(here) #tools for project-based workflow
library(ggraph) #plotting tools for networks
```


---
# Let's load our data 

This workshop assumes you did the work from week 1 and you know how to install libraries, read csv files into data, and to manipulate data in R. 

The benefit of having done the work previously is that we don't have to re-do it (unless we want to change something)

So I took the network at the end of workshop #1 and saved it as a .rds file. I could have saved it as a pair of csv files and rebuilt the network, but if I save as rds it will be ready to go!

To load an rds file the syntax is a little different:

```{r LoadNetwork, eval=FALSE}

gr <- readRDS(here("data", "WokshopNetwork.rds"))

```

```{r LoadNetworkForReal, echo=FALSE}

gr <- readRDS(here("static/slides/RForSNA/data", "WorkshopNetwork.rds"))

```
---
# Let's inspect our data

```{r InspectGr}
gr

```

---
# Let's plot it quickly

.pull-left[
## Which node is the most important?

````
```{r plotGr, eval = F}
gr %>%
  ggraph(layout = "kk") +
  geom_edge_link() +
  geom_node_point(aes(color = Dessert)) +
  theme(legend.position="bottom")
```
````

]

.pull-right[
```{r plotGrR, echo = F}
gr %>%
  ggraph(layout = "kk") +
  geom_edge_link() +
  geom_node_point(aes(color = Dessert)) +
  theme(legend.position="bottom")
```
]
---
# Let's explore centrality

### One view of importance is how many people you are connected to.
.pull-left[
- **Degree** = number of edges a node is involved in.
- **Indegree** = number of incoming edges
- **Outdegree** = number of outgoing edges

Lets calculate degree
````
```{r CalcDegree, eval = F}
gr %>%
  activate(nodes) %>%
  mutate(deg = centrality_degree()) %>%
  arrange(desc(deg))

```
]

.pull-right[

```{r CalcDegreeTrue, echo = F}
gr %>%
  activate(nodes) %>%
  mutate(deg = centrality_degree()) %>%
   arrange(desc(deg))
  
  
#head(deg)
```

]
---
